# Copyright 2021 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Check disk controller facts is not changed after hot remove disk
- include_tasks: ../../common/vm_get_disk_controller_facts.yml
- name: "Set fact of disk controller facts of VM '{{ vm_name }}'"
  set_fact:
    disk_controller_facts_new: "{{ disk_controller_facts['disk_controller_data'][new_ctrl_type] }}"
- debug:
    msg: "Get VM disk controller facts: {{ disk_controller_facts_new }}"
- name: "Check saved disk controller facts is the same as the one got above"
  assert:
    that:
      - disk_controller_facts_old == disk_controller_facts_new
    fail_msg: "Got VM disk controller facts: {{ disk_controller_facts_new }}, while before it's: {{ disk_controller_facts_old }}"
    success_msg: "Got VM disk controller facts is the same as got before."
