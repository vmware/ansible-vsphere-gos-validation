# Copyright 2024 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Description:
#   This test case is used for checking soft power operations
#   When VMware tools is not installed or not running in VM, this test case result is 'Blocked'.
#
- name: power_operation_script
  hosts: localhost
  gather_facts: false
  tasks:
    - name: "Test case block"
      block:
        - name: "Test setup"
          include_tasks: ../setup/test_setup.yml
          vars:
            skip_test_no_vmtools: true

        - name: "Test soft power script"
          include_tasks: set_power_script.yml
          vars:
            power_script_ops: item.rsplit('_', 1)[-1]
          with_items:
            - poweron_default_script
            - poweroff_default_script
            - poweron_custom_script
            - poweroff_custom_script
            - suspend_default_script
            - resume_default_script
            - suspend_custom_script
            - resume_custom_script
      rescue:
        - name: "Test case failure"
          include_tasks: ../../common/test_rescue.yml
