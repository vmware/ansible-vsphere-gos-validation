# Copyright 2022-2023 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Guest fullname of AlmaLinux is mapped "AlmaLinux (64-bit)" when
# VMware Tools version is 12.0.0 or later, ESXi version is 8.0.0 or later.
- name: "Set fact of guest_fullname for AlmaLinux with VMware Tools {{ vmtools_version }} on ESXi {{ esxi_version }}"
  ansible.builtin.set_fact:
    guest_fullname: "AlmaLinux ({{ guest_os_bit }})"
  when:
    - vmtools_version is version('12.0.0', '>=')
    - esxi_version is version('8.0.0', '>=')

# Guest fullname of AlmaLinux is mapped VM's guest OS version when:
# VMware Tools version is 12.0.0 or later, ESXi version is 7.0.3 or earlier.
- name: "Set fact of guest_fullname from VM's guest OS version"
  ansible.builtin.set_fact:
    guest_fullname: "{{ vm_guest_os_version }}"
  when:
    - vmtools_version is version('12.0.0', '>=')
    - esxi_version is version('8.0.0', '<')

# Guest fullname of AlmaLinux is mapped "Other N.x Linux (64-bit)" when
# VMware Tools version is 11.3.5 or earlier
- name: "Set fact of guest_fullname for AlmaLinux with VMware Tools {{ vmtools_version }} on ESXi {{ esxi_version }}"
  include_tasks: otherlinux_fullname_map.yml
  when: vmtools_version is version('12.0.0', '<')
