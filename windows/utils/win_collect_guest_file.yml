# Copyright 2024 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Description:
#   Collect VMWare tools logs to local test case log directory
#
# Parameters:
#   guest_file_path: file path to be collected in guest OS

- name: "Initialize facts for collecting file in guest OS"
  ansible.builtin.set_fact:
    guest_file_src: "{{ guest_file_path }}"
    guest_file_exists: false

- name: "Check file exists or not"
  include_tasks: ../utils/win_check_file_exist.yml
  vars:
    win_check_file_exist_file: "{{ guest_file_src }}"

- name: "Set fact of file existence in guest OS"
  ansible.builtin.set_fact:
    guest_file_exists: "{{ win_check_file_exist_result }}"

- name: "Collect file in guest OS"
  include_tasks: win_get_file.yml
  vars:
    win_get_file_src_path: "{{ guest_file_src }}"
    win_get_file_dst_path: "{{ current_test_log_folder }}"
  when: guest_file_exists
