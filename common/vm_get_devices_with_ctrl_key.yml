# Copyright 2021 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Get VM device with the device key
# Parameters:
#   device_controller_key: the device controller key
# Return:
#   device_list_with_ctrl_key: a list of devices with specified controller key
# 

- include_tasks: vm_get_config.yml
  vars:
    property_list: ['config.hardware.device']

- name: "Look for device with controller key '{{ device_controller_key }}'"
  set_fact:
    device_list_with_ctrl_key: "{{ vm_config.config.hardware.device | selectattr('controllerKey', 'equalto', device_controller_key | int) }}"

- name: "Print device info"
  debug: var=device_list_with_ctrl_key
