# Copyright 2021-2022 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Main playbook for launching guest OS validation testing on vSphere
- name: main
  hosts: localhost
  tasks:
    - name: "Set facts of the current main playbook directory and cache directory"
      set_fact:
        main_playbook_path: "{{ playbook_dir }}"
        local_cache: "{{ playbook_dir }}/cache"

    - debug:
        msg:
         - "Current main playbook directory: {{ main_playbook_path }}"
         - "Local cache directory: {{ local_cache }}"

    - name: "Create cache directory for downloaded/generated files"
      file:
        path: "{{ local_cache }}"
        state: "directory"
        mode: "777"
# Prepare testing environment 
- import_playbook: env_setup/env_setup.yml
# Execute test case one by one
- import_playbook: "{{ testing_testcase_file | default('linux/gosv_testcase_list.yml') }}"
# Cleanup testing environment
- import_playbook: env_setup/env_cleanup.yml
